<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Preview | QuizlyNotes</title>
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="static/css/quiz-preview.css">
</head>

<body class="app-shell">



      {% include "menu-bar.html" %}

      <main class="app-main">
        <section class="page-header">
            <div>
                <span class="page-badge">Quiz preview</span>
                <h1>Review your quiz before you study</h1>
                <p>Switch between recent quizzes, check your latest score, and jump straight into editing or practice mode.</p>
            </div>
            <div class="page-actions">
                <a href="/home" class="btn-secondary btn">Back to subjects</a>
                <a href="/upload" class="btn">Create new quiz</a>
            </div>
        </section>

        <div class="app-split">
        <aside id="side-menu" class="app-sidebar">
            <h3>Saved quizzes</h3>
            {% for set_item in other_sets %}
            <form method="POST" action="/quiz-preview-content" onsubmit="return submitSidebarForm(this)">
                <input type="hidden" name="set-id" value="{{ set_item.id }}">
                <button class="sidebar-button {% if loop.first %}is-active{% endif %}" type="submit">
                    {{ set_item.name }}
                </button>
            </form>
            {% endfor %}
        </aside>

        <section id="main-content" class="app-content-card">
            <div class="quiz-summary">
                <h1 id="title">{{ set.name }}</h1>
                <div class="quiz-score">{{ set.score }}%</div>
            </div>
            <div class="quiz-actions">
                <form method="POST" action="/open-quiz">
                    <input type="hidden" name="set-name" value="{{ set.name }}">
                    <button type="submit" class="btn" name="set-id" value="{{ set.id }}">Start quiz</button>
                </form>
                <form method="POST" action="/edit-quiz">
                    <input type="hidden" name="set-name" value="{{ set.name }}">
                    <button type="submit" class="btn-secondary btn" name="set-id" value="{{ set.id }}">Edit questions</button>
                </form>
                <form method="POST" action="/delete-quiz">
                    <input type="hidden" name="set-name" value="{{ set.name }}">
                    <button class="btn btn-danger" type="submit" name="set-id" value="{{ set.id }}">Delete quiz</button>
                </form>
            </div>
        </section>
        </div>
    </main>

        <script>
            function submitSidebarForm(form) {
                 const sidebarForms = document.querySelectorAll("#side-menu button");
                sidebarForms.forEach(f => f.classList.remove("is-active"));

                form.querySelector("button").classList.add("is-active");

                const formData = new FormData(form);

                fetch(form.action, {
                    method: "POST",
                    body: formData
                })
                    .then(response => response.text())
                    .then(html => {
                        document.getElementById("main-content").innerHTML = html;
                    });

                return false;

            }
        </script>


</body>

</html>