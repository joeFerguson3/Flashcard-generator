<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading - LearnlyAI</title>
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="static/css/quiz.css">
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2" defer></script>
    <script src="static/js/script.js" defer></script>


</head>

<body>
    <!-- Top Navigation Bar -->
    <header>
        <div class="logo">LearnlyAI</div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="/upload">Upload PDF</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
    </header>


    <!-- Progress bar -->
    <div id="progress-bar-back">
        <div id="progress-bar"></div>
    </div>


   <div class="question-box">
                <h3>Arrange the following steps of the TCP three-way handshake process in the correct order</h3>
                <form onsubmit="checkOrdering(event)" data-answer="[&quot;SYN segment is sent&quot;, &quot;SYN + ACK segment is received&quot;, &quot;ACK segment is sent&quot;]">
                    <ol>
                        
                        <li draggable="true" class="draggable">
                            SYN segment is sent
                        </li>
                        
                        <li draggable="true" class="draggable">
                            SYN + ACK segment is received
                        </li>
                        
                        <li draggable="true" class="draggable">
                            ACK segment is sent
                        </li>
                        
                    </ol>
                    <button type="submit">Confirm</button>
                </form>
            </div>

    {% if data %}
    {% for main_title, notes in data|groupby('main_title') %}
    
    <div id="{{ main_title }}" class="card-nav" {% if not loop.first %}style="display:none;" {% endif %}>
        <h2>{{ main_title }}</h2>
        <div class="main-title-block" id="{{ main_title }}">
            <button id="card-nav" style="margin-right: auto;" onclick="previousCard('{{main_title}}')"><img
                    src="static\images\back-arrow.svg"></button>
            {% for note in notes %}
            <!-- Display notes-->
            {% if loop.first %}
            <div class="sub-card" id="{{main_title}}{{ loop.index0 }}">
                {% else %}
                <div style="display: none;" class="sub-card" id="{{main_title}}{{ loop.index0 }}">
                    {% endif %}
                    <h3>{{ note.sub_title }}</h3>
                    <ul>
                        {% for line in note.content %}
                        {% set level = line | length - line.lstrip('-') | length %}
                        <li style="margin-left: {{ level * 20 }}px;">{{ line | lstrip('- ') }}</li>
                        {% endfor %}
                    </ul>
                </div>
                {% endfor %}
                <button style="margin-left: auto;" id="card-nav" onclick="nextCard('{{main_title}}')"><img
                        src="static\images\foward-arrow.svg"></button>
            </div>

            {% if loop.nextitem %}
            <button class="next-button" id="next-button{{main_title}}"
                onclick="next('{{main_title}}')">Continue</button>
            {% endif %}
            <div id="card_num_container{{ main_title }}"" class=" card-num">
                <span id="card_num_{{main_title}}">0</span>
            </div>
        </div>


        <!-- Display questions -->
        {% for q in questions %}

        {% if q.title == main_title %}
        {% if q.type == "fill-in-blank" %}
        <div class="question" id=" q{{main_title}}{{ loop.index }} ">
            <div class="question-box">
                <form method="post">
                    <h3>{{q.type}}</h3>
                    <p>
                        {% set parts = q.question.split("{blank}") %}
                        {% for part in parts %}
                        {{ part }}
                        {% if not loop.last %}
                        <input class="blank-textbox" type="text" name="answer_{{ loop.index0 }}" size="10"
                            data-answer="{{ q.answer[loop.index0] }}" />
                        {% endif %}
                        {% endfor %}
                    </p>
                </form>
            </div>
            <button class="next-button" id="next-button q{{main_title}}{{ loop.index }} "
                onclick="next(' q{{main_title}}{{ loop.index }} ')">Continue</button>
        </div>

        {% elif q.type == "true-false" %}
        <div class="question" id=" q{{main_title}}{{ loop.index }} " >
            <div class="question-box">
                <h3>{{q.question}}</h3>
                <form class="true-false-form">
                    <button onclick="checkAnswerTF(event, '{{ q.answer }}')" id="answer_{{ loop.index }}_T" value="true">True</button>
                    <button onclick="checkAnswerTF(event, '{{ q.answer }}')" id="answer_{{ loop.index }}_F" value="false">False</button>
                </form>
            </div>
            <button class="next-button" id="next-button q{{main_title}}{{ loop.index }} "
                onclick="next(' q{{main_title}}{{ loop.index }} ')">Continue</button>
        </div>

        {% elif q.type == "multiple-choice" %}
        <div class="question" id=" q{{main_title}}{{ loop.index }} ">
            <div class="question-box">
                <h3>{{q.question}}</h3>
                <form class="true-false-form">
                    {% for opt in q.options %}
                        <button onclick="checkAnswerTF(event, '{{ q.answer }}')" value="{{ opt }}">{{ opt }}</button>
                    {% endfor %}
                </form>
            </div>
            <button class="next-button" id="next-button q{{main_title}}{{ loop.index }} "
                onclick="next(' q{{main_title}}{{ loop.index }} ')">Continue</button>
        </div>

        {% elif q.type == "short-answer" %}
        <div class="question" id=" q{{main_title}}{{ loop.index }} ">
            <div class="question-box">
                <p> {{ q.question }}</p>
                {{ q.answer }}
                <form method="post">
                    <textarea name="answer_{{ loop.index }}" class="answer-box"
                        data-answer="{{ q.answer }}" rows="3" cols="40"></textarea>
                </form>
            </div>
            <button class="next-button" id="next-button q{{main_title}}{{ loop.index }} "
                onclick="next(' q{{main_title}}{{ loop.index }} ')">Continue</button>
        </div>

        {% elif q.type == "ordering" %}
        <div class="question" id=" q{{main_title}}{{ loop.index }} ">
            <div class="question-box">
                <h3>{{q.question}}</h3>
                <form onsubmit="checkOrdering(event)"  data-answer='{{ q.answer |tojson }}'>
                    <ol>
                        {% for opt in q.options %}
                        <li draggable="true" class="draggable">
                            {{ opt }}
                        </li>
                        {% endfor %}
                    </ol>
                    <button type="submit">Confirm</button>
                </form>
            </div>
            <button class="next-button" id="next-button q{{main_title}}{{ loop.index }} "
                onclick="next(' q{{main_title}}{{ loop.index }} ')">Continue</button>
        </div>
        {% endif %}

        {% endif %}

        {% endfor %}

        {% endfor %}
        {% endif %}
        <form method="POST" action="/end-quiz">
            <input type="hidden" name="set-id" value="{{ set_id }}">
            <button type="submit" class="quiz-button">
                <h2> Finish </h2>
            </button>
        </form>

</body>

</html>